const rust_ecrecover = require('../utils/ecrecover')

const messageHash = Buffer.from([
  0x0a, 0x1e, 0x27, 0x23, 0xbd, 0x7f, 0x19, 0x96, 0x83, 0x2b, 0x7e, 0xd7, 0x40, 0x6d, 0xf8, 0xad, 0x97, 0x5d,
  0xeb, 0xa1, 0xaa, 0x04, 0x02, 0x0b, 0x5b, 0xfc, 0x3e, 0x6f, 0xe7, 0x0e, 0xcc, 0x29,
])
const v = 27
const r = Buffer.from('3bcdbbe689224248b2dc4b669ad83dc7b3af9f8ec5ed7a42b7fcfb3110229cfb', 'hex')
const s = Buffer.from([
  0x24, 0x43, 0x67, 0x93, 0x9f, 0xe8, 0x50, 0xeb, 0xb2, 0x5c, 0x3e, 0x6a, 0x02, 0xbb, 0x9e, 0xd0, 0x87, 0x31,
  0x6d, 0xac, 0x75, 0xc0, 0xc0, 0x5e, 0xba, 0xba, 0x68, 0x39, 0xe7, 0x5f, 0x1c, 0xc4,
])

let totalTime = 0
const runs = 1000


for (let i = 0; i < runs; i++) {
  const startTime = process.hrtime()
  rust_ecrecover.ecrecover(messageHash, v, r, s)
  const [seconds, nanoseconds] = process.hrtime(startTime)
  totalTime += seconds * 1000 + nanoseconds / 1e6 // convert to milliseconds
}

const averageTime = totalTime / runs
console.log(`Average time per rust run: ${averageTime} ms`)
